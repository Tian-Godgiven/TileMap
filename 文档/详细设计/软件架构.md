[toc]

# 软件架构的实现

## 客户端

（1）构建应用程序：使用Electron框架构建应用程序。通过main.js中的BrowserWindow模块，将软件基础页面main.html装载到实例化窗口中。随后会沿着Html中的路由与js文件进行调用，最终在窗口中实现整个应用程序。此外，对窗体样式进行修改：隐藏原生的窗体菜单栏，窗体颜色与用户默认主题同步，将窗体图标修改为本软件的图标。

Electron的应用窗体内嵌套的便是Chromium，这个渲染引擎对最新的ES6语法提供了完备的支持，通过渲染指定的.html文件，在应用窗体内显示我们的程序前端内容。相较于Vue和React等框架，Electron并没有提供文件路由服务，这是因为在Electron中.html文件的渲染依赖于应用窗体的读取，也就是loadFile()方法，而一个应用窗体只能在同一时间读取单个的.html文件。因此，要在不引入新的框架的情况下，在Electron中实现模块化的开发，需要在主页面main.html中通过js方法，依次加载其他的.html文件。

（2）打包生成客户端：通过转化脚本，将构建的应用程序项目导入Electron forge中，对其进行打包，构建exe启动项，生成可用于分发和使用的客户端程序。此外，对生成打包的package.json脚本进行设置，设定了应用程序的图标和资源文件路径。

​		electron-forge是目前Electron官方首推的electron应用打包插件，但其本身还存在一些问题。例如其使用的asar加密方式会导致项目中对数据文件的写操作失效，必须通过本地的appData进行应用数据管理，严重影响项目对静态资源文件的管理。又例如其对跨平台环境运行的支持，导致打包后的文件中会有20MB的内容是对macOS与Linux系统的支持，这对小型项目来说，是相当大的累赘。尽管有着一定弊端，electron-forge的确能够提供相对完善的应用打包服务。

## 数据库

使用SQLyog构建MySQL数据库。

## 服务端

（1）搭建服务器：使用Node.js的Express框架，搭建本地服务器，响应客户端操作。服务器包含响应系统与数据库操作系统。分别用于相应客户端请求和操作数据库。

（2）连接数据库：通过Node.js的Mysql2组件，令服务器与数据库相连，服务器在处理部分请求时，需要查询数据库中的信息，或修改数据表的内容。

（3）连接客户端：通过Express搭建的服务器框架，可以处理来自客户端的fetch请求，从而令服务器与客户端相连，服务器接受来自客户端的请求，并做出相应的响应。

​		在服务端使用Express中间件，客户端使用fetch插件的最大的好处就是简化了代码结构，简化开发流程，并且提高了代码的可维护性。这两者都支持模块化封装，也提高了代码的可重用性。