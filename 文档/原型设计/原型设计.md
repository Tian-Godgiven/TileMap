[toc]

# 系统架构设计

客户端整体为一款Web应用程序，基于JavaScript完成功能开发，使用Electron框架实现应用程序的生成与打包。服务端的实现基于Node.js的Express中间件，负责响应来自客户端的需求，连接到服务端数据库。数据库是通过SQLyog搭建的MySQL数据库系统，负责存储用户数据。

其中，客户端通过Fetch请求向服务端发送需求，并接受来自服务端的回应。客户端通过Mysql2中间件连接并控制数据库。

# 客户端界面与功能设计

客户端的界面采用常见于设计类软件的三分模块，模块具体的内容与对应的功能如下：

## 顶部功能区

位于客户端顶部，包含与应用程序本体有关的各类功能，包括：

（1）客户端图标：显示本项目的图标。

（2）当前文件名：显示应用程序当前打开的工程文件的名称。

（3）用户头像：当前用户为未登录状态时显示游客头像，点击后弹出登录子菜单。否则显示当前已登录的用户头像，点击后弹出子菜单，选项包括：个人页面，创建房间，退出登录，功能分别对应：进入用户的个人页面，以当前工程文件创建一个在线设计房间，退出当前登录的账户。

（4）文件操作：点击后显示文件子菜单，包括对文件的各类操作：新建工程文件，打开新工程文件，从最近使用的工程文件中选择打开，保存当前工程文件，将当前工程文件另存为其他格式，导入自定义磁贴或模板文件进软件中，将选中的磁贴或组合体导出为自定义磁贴文件或模板文件或图片格式文件，关闭当前工程文件。

（5）编辑操作：点击后显示编辑子菜单，在此处进行对画布区编辑的操作。包括：撤销，重做，剪切，复制，粘贴，删除。这些功能也可以在画布区的功能菜单中进行，或者使用快捷键，在此处额外放置是为了提供给用户更多样化的操作方式。

（6）界面操作：点击后显示界面子菜单，在此处进行对应用程序界面的显示操作。包括：界面显示：选择控制左右两侧和顶部的功能栏的显示状态和显示位置。界面分离：选择控制左右两侧的功能栏或其子功能栏的分离状态，可以将其从软件的结构中分离，不再占用界面显示空间，并且可以被移动位置。

（7）切换磁贴内容的显示：点击后可以切换应用程序全局是否显示磁贴内容，这个操作不会保存，仅作用于对当前工程文件的操作。一部分情况下，用户可能不需要显示磁贴的内容块，使用此功能可以快捷地隐藏所有磁贴的内容块，并且不会产生额外操作。

（8）搜索：点击后弹出搜索框，输入内容后，即可在当前文件中搜索名称，或对应内容块中包含搜索内容的画布，磁贴，磁贴内容块，线条，搜索结果会显示在菜单中，点击对应的搜索对象，既可以移动到该对象所处的画布下，并将其选中，显示在画面中心。

（9）其他操作：包含在子菜单内的简单功能，包括：修改软件语言、修改软件主题、开启或关闭自动备份；打开开发者工具、查看客户端版本号、查看制作人员名单；修改夜间或白天模式；修改软件的显示状态，显示为窗口或全屏状态。

## 对象交互区

​	默认位于软件左侧，包含思维导图设计过程中使用到的对象的交互操作：

（1）创建画布：点击后弹出画布创建菜单，确认创建时将在画布区创建一张新画布。

（2）搜索磁贴类型：输入搜索内容后，即可筛选出名称符合搜索内容的磁贴，并显示在独立的搜索结果磁贴菜单中。

（3）磁贴菜单：依次排列着不同分类的菜单，菜单内部保存着不同形状或类型的磁贴元素，显示保存在内的磁贴元素的缩略图，将对应缩略图从中拖拽到画布区域，即可创建新的该缩略图对应的磁贴元素。用户可以自定义这些菜单的显示顺序，并通过点击收起或展开菜单的内容。

（4）模板菜单：内部保存有常用的各种类型的思维导图模板，并显示其缩略图，将对应缩略图从中拖拽到画布区域，即可创建新的该缩略图对应的思维导图模板。

（5）快捷使用：一个特殊的菜单，显示在所有菜单之上，用户可以将自定义设计的磁贴或模板保存到该菜单下以便快捷使用。点击该菜单上的编辑按钮后，弹出对应的的编辑子菜单，用户可以在该子菜单下改变已保存的磁贴或模板的顺序位置，编辑已保存的磁贴或模板的名称，删除选择的已保存磁贴或模板，向快捷使用菜单内导入自定义磁贴或模板的文件，或者将选中的已保存磁贴导出为自定义磁贴文件，已保存模板导出为模板文件。

（6）分类设置：点击该按钮后，将弹出磁贴菜单的创建菜单，在这里用户可以创建自定义的磁贴菜单，设定菜单名称。自定义磁贴菜单的功能与快捷使用菜单一致，在此基础上，已登录用户还能够将磁贴菜单中的内容上传到其账户下，并在个人界面下载已上传的磁贴菜单，显示在元素交互区。

## 画布修饰区

​	与以下三个区域共享位置，默认位于软件右侧。当聚焦对象为画布时，在样式栏中切换，包含与画布有关的修饰功能：

（1）画布属性：显示当前画布的名称，点击右侧的编辑按钮，弹出画布重命名菜单，可以为该画布重命名。显示当前画布的尺寸，可以通过通过选择栏选择预设的画布尺寸，也可以通过在显示栏内修改画布尺寸的数值改变画布尺寸。

（2）画布显示：显示当前画布的背景颜色，点击拾色器弹出调色盘菜单，可以为该画布修改背景颜色。

（3）画布网格：可以为画布增添网格背景，修改网格背景的网格密度和颜色

（4）背景图片：可以为画布插入图片背景，并修改背景图片的显示模式，可选放置、拉伸或重复，在放置和重复选项下，还可以修改背景图片画布中的位置。

## 画布内容区

​	当聚焦对象为画布时，在内容栏中切换。

在当前画布中的所有对象，会在该区域按行排列，以对应背景颜色的缩略图与磁贴文本的格式显示。若磁贴嵌套了画布，还会在其下方显示画布图标与其所嵌套的画布的名称。若磁贴的内容块脱离了磁贴，会在这个磁贴的下方显示一个内容块图标。

点击该内容区中的各缩略图或内容块图标会令画布移动，使得该磁贴或脱离了磁贴的内容块显示在画布区域中心并被聚焦选中。点击磁贴下方的画布图标会移动到对应的画布。

## 磁贴修饰区

​	当聚焦对象为磁贴时，在样式栏中切换。包含与磁贴有关的修饰功能，这些功能被分为图形，文本，内容三个部分，点击对应部分的标题即可将其内容收起或展开。

（1）背景颜色：显示当前磁贴的背景颜色，点击拾色器可以修改磁贴的背景颜色。

（2）背景图片：可以为磁贴插入图片背景，并修改背景图片的显示模式，可选放置，拉伸或重复，在放置和重复选项下，还可以决定图片在背景中的位置。

（3）渐变色：可以为磁贴添加渐变色背景，可以决定渐变色背景的颜色和方向，当同时存在背景图片和渐变色背景时，会在背景图片的基础之上显示渐变色背景。

（4）磁贴位置：显示磁贴位于当前画布中的位置，可以通过修改位置的数值来改变磁贴的位置。

（5）旋转角度：显示磁贴当前的旋转角度，可以通过修改角度的数值来改变磁贴的旋转角度。

（6）磁贴大小：显示磁贴当前的宽度和高度，可以通过修改高度或宽度的数值来改变磁贴的大小。能够通过比例限制的选项，令磁贴在改变大小时保持选中该选项时的高宽比。

（7）磁贴形状：点击后弹出形状选择子菜单，可以在此处选择并修改磁贴的形状。

（8）磁贴边框：显示磁贴当前的边框状态，通过选项和修改数值改变磁贴的边框状态，包括边框的类型、粗度、颜色、弧度。

（9）磁贴层叠：显示磁贴在当前画布的层叠值，即显示优先级，可以通过按键以1为步长修改，也可以通过按键令磁贴的层叠修改为当前画布的最前方或最后方。

（10）磁贴样式：可以通过选项锁定磁贴，使其的样式无法被修改，具有的各类功能也无法起效。可以通过按键复制磁贴的样式，或将已复制的样式粘贴到当前选中的磁贴上。可以通过按键将磁贴加入指定的快捷使用栏或自定义磁贴菜单。

（11）磁贴标题：显示磁贴当前所输入的标题内容，也可以选择是否显示磁贴的标题。

（12）自动换行：选择磁贴当前所输入的标题内容是否自动换行，若为是，则当磁贴标题的长度超过磁贴的宽度时，其会自动换行。

（13）标题位置：选择控制磁贴的标题显示在相较于磁贴显示的位置，包括横向左、右、居中，和竖向上、下、居中共9种组合。

（14）磁贴字体：选择控制磁贴的标题的字体样式，包括字体类型、颜色、大小、加粗、斜体、垂直、上划线、中隔线、下划线、左对齐、居中对齐、右对齐。

（15）字体阴影：选择为磁贴的标题添加阴影样式，可以设定阴影的颜色，位置，模糊距离。

（16）绑定链接：选择为磁贴绑定一个链接，绑定成功时，当点击这个磁贴时，会弹出一个链接跳转提示框，由该提示框跳转至绑定的链接，可以选择禁用链接跳转提示框。

（17）添加注释：选择为磁贴添加一段注释，添加后，当鼠标移到磁贴上方时，会在鼠标下方显示这段注释，当鼠标移出该磁贴后这段注释就会消失。

（18）嵌套画布：点击按键后弹出嵌套画布菜单，在该菜单内选择为磁贴嵌套的画布，随后便可以通过该按键进入磁贴嵌套的画布。选择设定通过该磁贴进入画布的方式，包括双击进入画布（与双击修改磁贴标题的功能互斥），点击侧栏按键进入画布，以及禁止通过该磁贴进入画布。

（19）内容块设定：显示磁贴对应的内容块的尺寸，通过改变数值修改对应内容块的大小。通过选项修改内容块对应磁贴的显示位置，包括垂直方向的上、下、对齐和水平方向的左侧、左对齐、居中、右对齐、右侧，共15种组合位置。还可以修改该磁贴对应的内容块的显示方式，包括当磁贴被聚焦时显示，保持显示和保持隐藏。最后还能修改是否令该内容块与磁贴绑定。

## 磁贴内容区

​	当聚焦对象为磁贴时，在内容栏中切换，包含对磁贴的内容块中的内容的显示与修饰功能：

（1）内容显示：显示磁贴的标题与其对应的内容块中的内容，可以在该区域内选中部分内容以供修饰。

（2）内容修饰：提供对磁贴内容的修饰功能，若没有在“内容显示”区域内选中部分内容，则会修改磁贴的所有内容。包括：字体类型、颜色、大小、加粗、斜体、上划线、中断线、下划线、左对齐、居中对齐、右对齐、背景颜色；文本边框及其颜色、粗细、弧度；插入超链接、图片、表格、磁贴对象、画布对象、Html代码；清空所有的内容。

## 画布区

​	用于放置并显示画布和画布元素，是软件中占比最大的界面，从上往下分为三个部分：

（1）设计功能区：主要为与设计编辑与画布操作相关的功能，包括：放大缩小当前画布，显示当前画布的缩放幅度；撤回与重做；删除选中的画布内对象；令选中的画布内对象上浮或下沉，在当前画布内的层叠+1或-1；调出调色盘，修改选中画布内对象的颜色；修改选中的线条对象的样式，修改选中的线条对象的连线规则；弹出插入对象子菜单，选择向当前画布中插入图片、超链接、表格、文本、基础形状的磁贴或嵌套了画布的磁贴等对象。若当前画布是一张嵌套画布，即其被嵌套进了另一张画布的磁贴内时，会在设计功能区的左侧下方显示返回按键，点击后即可返回到这个嵌套画布所关联的磁贴所在的画布；在右侧下方显示关闭按键，点击后即可关闭这个嵌套画布，回到其顺位的上一张画布。

（2）画布放置区：显示并放置画布及画布内元素的区域，在该区域内移动或选中画布内对象。在该区域的左右两侧分别存在一个宽度操作栏，当鼠标移动在其上方时显示，按住并拖动该操作栏，可以随鼠标改变画布区的宽度，同时改变在该方向与画布区邻接的区域的宽度。当画布放置区内没有画布即没有文件时，右键该区域弹出子菜单，选项分别为创建新的工程文件和从本地打开工程文件。

（3）切换按键区：依次显示画布对应的切换按键。点击切换按键即可切换显示对应的画布；点击并拖动可以修改切换按键之间的顺序；右键点击切换按键弹出子菜单，选项包括：重命名画布，拷贝画布，删除画布，分别对应为对应画布重命名，生成一张对应画布的拷贝，删除对应画布。当该区域无法显示所有切换按键时，会在右侧显示可以令切换按键左右移动的按键，从而令用户可以点击到被隐藏的切换按键。

## 个人主页

​	独立于上述区域的跳转页面，包含已登录用户的账户信息和在线服务操作：

（1）头像：显示用户设定的头像，点击后弹出头像修改菜单，用户可以选择本地图片上传以修改头像。

（2）用户名：显示用户设定的用户名，点击其旁边的编辑键，可以进行重命名，名称会同步到服务器。

（3）创建房间：令当前工程文件作为房间创建，若当前不存在工程文件，则先创建一个新的工程文件，再令其作为房间创建。

（4）关闭房间或退出房间：若用户当前已经在一个房间内，则上述创建房间按键会根据用户在当前房间内的权限修改，若用户为该房间的房主，则可以关闭房间，非房主的用户则可以退出该房间。

（5）退出登录：已登录的用户可以在该界面选择退出当前账号的登录。

（6）已上传内容：用户可以在此处管理其上传到该账号下的自定义内容，例如自定义磁贴菜单、磁贴和模板，可以选择下载并同步到当前软件，修改内容名称，删除指定内容，导入自定义文件，将指定内容导出。

（7）已保存文件：用户可以在此处管理其上传保存到该账户下的工程文件，可以选择下载到本地并打开，修改文件名称，删除指定文件。

# 对象结构设计

​	JavaScript是一个以对象为核心的语言，几乎所有操作都基于对象进行。而思维导图也是一个以图形对象为语素的表达方式，因此在本软件中，对象类的定义会影响到整体的功能设计与实现。

## 工程文件

​	工程文件是本软件最基础的处理对象，每个工程文件包含至少1张画布，工程文件只能在本软件内正确打开。工程文件的结构当中应当包含文件信息与文件数据，软件将通过读取文件信息识别其正确性和可支持性，对于较久版本的不再提供支持的工程文件，应提示用户使用旧版本的软件打开。文件数据中应当包含这个工程文件的所有内容，软件通过该读取这些数据，生成对应的画布与画布内元素，从而在工作区打开该文件。工程文件涉及的方法主要包括新建、打开、保存等。此外，还应该为用户提供将工程文件另存为其他格式的文件，以便于查看内容的功能。

## 画布

画布是思维导图设计流程中的载体，所有设计元素都需要放置在画布上才能显示。画布对象也是工程文件对象的第一层子对象。根据需求，应当至少存在两种类型的画布对象，一种是普通画布，另一种是嵌套画布。嵌套画布在一般情况下应当不会显示，只有在打开和进入嵌套画布时，才会像普通画布一样显示。

画布对象涉及的方法包括：创建，删除，拷贝，重命名，聚焦，切换画布，拖动，缩放大小，改变尺寸，画布子菜单，样式修改方法。若为嵌套画布，则还拥有通过磁贴打开画布，返回上一层画布，关闭嵌套画布等方法。

## 磁贴

磁贴是思维导图设计流程中的基础设计元素，其设计原型是window10系统在开始界面内为用户提供的可自定义位置和形状的方块元素。磁贴对象通过两种方式存储信息，分别是显示在磁贴表面的磁贴标题和蕴藏在磁贴内部的磁贴内容。磁贴需要放置在画布中，可以被任意移动，并且拥有大量的自定义选项控制其各种类型的样式。

磁贴可以绑定一个内容块以显示磁贴内容，磁贴之间可以通过线条相连、能够组成组合体，并且还能够向磁贴对象嵌套一个画布，可以通过该磁贴进入目标画布。

磁贴对象涉及的方法为：创建，删除，复制，粘贴，修改标题文本，聚焦，取消聚焦，拖动，改变尺寸，改变形状，磁贴子菜单，显示与隐藏内容块，锁定，绑定与打开链接，显示注释，嵌套画布与进入嵌套画布，连接线条，加入磁贴菜单，导出为自定义磁贴文件，上传到登录账户，样式修改方法。

## 内容块

​	内容块是可以绑定在磁贴上的信息元素，用于显示磁贴自身不便展示的多余的信息内容以减少导图整体的冗余性。内容块通常会随着指定的显示方法，显示在绑定的磁贴所指定的位置，也可以令其脱离磁贴，独立存在，此时内容块所显示的内容仍然与磁贴的磁贴内容绑定。

内容块的方法包含：显示，隐藏，改变尺寸，改变显示状态，样式修改方法。若脱离了磁贴后，独立的内容块便可以被拖拽改变位置，且独立于磁贴修改样式。

## 线条

​	线条是思维导图设计过程中的另一基础设计元素，线条链接着两个磁贴，链接端会随着磁贴一起移动，能够自定义其一部分样式。线条也会参与构成组合体。

线条对象的方法为：创建，删除，复制，粘贴，修改线条文本，聚焦，取消聚焦，拖动，拖动两端改变尺寸，线条子菜单，绑定与脱离磁贴，样式修改方法。

## 组合体

​	组合体是由不少于1个磁贴对象和线条对象组合形成的集体，这些对象被视为组件，构成的组合体被视作一个完整的对象。可以在选中组合体后，再选中其中的元素。组合体可以被保存为一个模板，模板在画布中以组合体的形式显示。组合体内的成员的一部分方法将会受到限制，例如移动，改变状态等。在画布内拖选多个元素时，会形成临时组合体，将临时组合体固定便成为了一个组合体。若使用组合体参与构成新的组合体，原有的组合体将解除组合。组合体本身不具有样式，对组合体的样式修改方法会作用于其内部的所有成员。

组合体对象囊括的方法有：创建，删除，复制，粘贴，聚焦，取消聚焦，拖动，组合体子菜单，解除组合，加入磁贴菜单，导出为模板文件，上传到登录账户，修改其构成成员的样式的方法。

# 服务端功能设计

在本软件中，服务器的主要作用是为用户提供在线服务的平台，负责处理客户端向服务器发送的各种请求。这些在线服务包括用户系统，上传与下载和在线房间。

## 用户系统

​	用户被分为注册用户与游客。

（1）注册：用户在注册界面输入邮箱，用户名和密码，在收到确认邮件后，在该界面输入确认邮件中的验证码，即可完成注册。

（2）登录：注册用户在登录界面输入注册邮箱与正确的密码后，即可完成登录。登录用户可以上传并显示头像，重新设定用户名和登陆密码，创建在线房间，上传或下载自定义磁贴、模板和工程文件。

（3）游客：未登录状态下，用户为游客身份。游客能够使用所有的客户端基础功能，但无法享受登录用户的权限。游客也可以通过房间码进入在线房间，但将默认被分配至游客用户组，仅拥有查看与少量交互的权限。

## 上传与下载

​	登录用户在服务器的文件系统中拥有一定的数据库空间来存储其上传的文件，同时也能够通过服务器下载其上传的文件内容。

（1）头像与用户名：登录用户可以上传自定义的图片作为其头像，也可以修改头像和用户名。通常使用用户名作为用户身份的标识。

（2）自定义内容：登录用户可以将自定义的磁贴，模板，磁贴菜单上传到账户，并可以在登录后下载这些内容。

（3）工程文件：登录用户可以将当前工程文件，或选择本地保存的工程文件上传到账户，并可以在登录后下载这些文件。

## 在线房间

​	在线房间是一个基于工程文件的，与服务器端双向通信来实现数据同步的虚拟空间。加入在线房间的用户可以按自身的权限操作同一个工程文件，所有用户的操作都会上传至服务器，再通过在线房间传至其他用户的客户端中。

（1）创建房间：登录用户作为房主，将其当前工程文件，或指定的工程文件上传至服务器，以此创建一个在线房间。房主能够选择设定房间密码。房主会获得该在线房间对应的房间码，并用其邀请其他用户进入房间。在该过程中，房主能够设定房间的成员组，以及这些成员组拥有的权限。

（2）房间码：每个在线房间都拥有唯一的房间码，只有输入正确的房间码才能连接到对应的在线房间。若房主为该在线房间设定了房间密码，则还需要输入正确的房间密码。房间码将在该房间关闭后失效。

（3）成员组：所有加入房间的成员都会被分配到成员组中，默认拥有四种成员组：房主，管理员，成员，游客。房主和管理员可以设定除房主以外的成员组的名称和各自拥有的房间权限，创建新的成员组或是删除除房主以外的成员组，将非房主成员分配到除房主以外的成员组中或将该成员移出房间。

（4）房间权限：房主和拥有控制权限的管理员可以指定在线房间中的除房主以外的成员组的权限，这些权限包括：管理成员组的成员，管理成员组的权限，保存或上传思维导图，编辑思维导图，思维导图交互。在默认的成员组中，房主和管理员拥有上述所有权限，成员拥有保存，编辑，交互权限。游客仅拥有交互权限。

（5）在线创作：用户可以在在线房间内，按照自身所在的用户组的权限对工程文件进行创作与浏览。当用户选中某个画布内对象时，其用户名会显示在该对象旁边，此时，另一个用户便无法选中或操作这个画布内对象。用户在创作过程中使用撤销或重做时，只能撤销或重做自身之前进行的操作，无法影响其他用户进行的操作。

（6）退出房间：非房主用户可以随时选择退出房间，在这之后其仍然可以在房间码有效期间内通过房间码和可能存在的密码进入该房间。

（7）关闭房间：只有房主可以关闭房间。房间关闭后，房间码会失效，所有成员都会被移出房间。

# 数据库设计

本项目中的数据库作为存储后端信息的平台提供各类信息验证服务，内容包括用户的注册账户信息，用户在该账户下上传的内容，用户创建的在线房间的信息。

## 用户账户表

存储用户账户的注册信息，在验证登录身份时进行查询与核对，返回用户头像的存储路径和用户名称。其中id项作为其他表的外键，因此该表为整个数据库的核心表。

 

表1 用户账户表

| 属性名         | 描述               | 类型    | 长度 | 允许空 |
| -------------- | ------------------ | ------- | ---- | ------ |
| id             | 自增长主键，唯一   | INT     | 10   | 否     |
| user_name      | 用户名             | VARCHAR | 255  | 否     |
| user_icon_path | 用户头像的存储路径 | VARCHAR | 255  | 是     |
| password_hash  | 密码哈希值         | VARCHAR | 255  | 否     |
| email          | 用户注册邮箱       | VARCHAR | 255  | 否     |
| hash_salt      | 密码哈希盐         | VARCHAR | 255  | 否     |

 

## 用户上传内容表

用户可以通过账户上传自定义磁贴文件、模板文件或工程文件，这些文件存放在服务器的文件系统中。该表用于存储用户上传的文件信息，在删除或下载服务端存储的文件时，提供对应文件的路径。也负责存储与传递用户为上传文件添加的备注。

 

表2 用户上传内容表

| 属性名      | 描述                           | 类型      | 长度 | 允许空 |
| ----------- | ------------------------------ | --------- | ---- | ------ |
| id          | 自增长主键，唯一               | INT       | 10   | 否     |
| user_id     | 用户id，通过外键指向用户账户表 | INT       | 10   | 否     |
| upload_time | 上传时间                       | TIMESTAMP | null | 否     |
| file_path   | 文件路径                       | VARCHAR   | 255  | 否     |
| file_info   | 文件备注                       | VARCHAR   | 255  | 是     |

 

## 在线房间表

​	用户创建在线房间时，将会在数据库的在线房间表中添加该房间信息，关闭在线房间时，删除该表中对应的房间信息。在用户输入房间码进入房间时，对房间码和房间密码进行验证。也保存了房间的状态信息，以控制是否允许更多人进入到在线房间中。

 

表3 在线房间表

| 属性名     | 描述                           | 类型      | 长度 | 允许空 |
| ---------- | ------------------------------ | --------- | ---- | ------ |
| room_id    | 房间码，主键，唯一             | VARCHAR   | 20   | 否     |
| user_id    | 房主id，通过外键指向用户账户表 | INT       | 10   | 否     |
| open_time  | 房间创建时间                   | TIMESTAMP | null | 否     |
| file_path  | 房间的工程文件路径             | VARCHAR   | 255  | 否     |
| room_code  | 房间密码                       | VARCHAR   | 255  | 是     |
| room_state | 房间开启状态                   | bool      | 1    | 否     |

  

## 房间成员组表

​		存储各在线房间中的成员组信息保存各房间中的成员组拥有的权限，在管理房间成员组，分配和验证成员组权限提供对应的成员组信息。通过房间码指向对应的在线房间表，当在线房间项被删除时，也会删除对应的房间成员组项。

 

表4 房间成员组表

| 属性名                 | 描述                           | 类型    | 长度 | 允许空 |
| ---------------------- | ------------------------------ | ------- | ---- | ------ |
| id                     | 自增长主键，唯一               | INT     | 10   | 否     |
| group_name             | 成员组名称                     | VARCHAR | 255  | 否     |
| room_id                | 房间码，通过外键指向在线房间表 | VARCHAR | 10   | 否     |
| save_permission        | 保存权限                       | bool    | 1    | 否     |
| edit_permission        | 编辑权限                       | bool    | 1    | 否     |
| interactive_permission | 交互权限                       | bool    | 1    | 否     |
| close_permission       | 关闭权限                       | bool    | 1    | 否     |

 

## 房间成员表

​		存储各房间的成员信息，在管理房间成员和成员分组时提供对应的成员信息。设定上，游客也可以进入房间，因此并不使用用户账户的id作为主键。

表5 房间成员表

| 属性名      | 描述                                     | 类型    | 长度 | 允许空 |
| ----------- | ---------------------------------------- | ------- | ---- | ------ |
| id          | 自增长主键，唯一                         | INT     | 10   | 否     |
| member_id   | 成员的账户id，通过外键指向用户账户表     | INT     | 10   | 是     |
| member_name | 成员的用户名                             | VARCHAR | 255  | 否     |
| Group_id    | 所属成员组的id，通过外键指向房间成员组表 | VARCHAR | 255  | 否     |
| Room_id     | 房间码，通过外键指向在线房间表           | VARCHAR | 10   | 否     |

 